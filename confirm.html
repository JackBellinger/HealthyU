<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Confirmation</title>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
	<div>TODO write content</div>
	
	
    <!--type above here please --> 
		
		
		
		<form name = "symptomChecks" method="post" style="font-size:20px;">
            <fieldset>
                <input type="button" value="Find Products" style="padding:10px; color: black;" onclick="onClick();"/>
            </fieldset>
        </form>
        <script>
            var text = window.location.hash.substring(1);
            var items = text.split(",");
			var user = document.cookie;
			
			console.log(user);
			var pickupAddress;
			var dropoffAdress;
            var deliveryQuoteId;
            function onClick(){
                id = deliveryQuote();
				createDelivery(item, id);
            }
            function deliveryQuote() {
                var data = new FormData();
                data.append("pickup_address", "1600 walnut street");
                data.append("dropoff_address", "1508 chestnut street");

                var xhr = new XMLHttpRequest();
                xhr.withCredentials = true;

                xhr.addEventListener("readystatechange", function () {
                    if (this.readyState === 4) {
						var json = JSON.parse(xhr.responseText);
						var id = json.id;
						console.log(this.responseText);
                        console.log(id);
                    }
                });

                xhr.open("POST", "/api/postmates/customers/cus_Ke9kOEURVrKV7V/delivery_quotes");

                xhr.send(data);
				return id;
            }
			function createDelivery(item, id){
				var data = new FormData();
				data.append("quote_id", id);
				data.append("manifest", item);
				data.append("pickup_name", "cvs");
				data.append("pickup_address", "1600 walnut street");
				data.append("pickup_phone_number", "3014040071");
				data.append("dropoff_name", "place");
                data.append("dropoff_address", "1508 chestnut street");
				data.append("dropoff_phone_number", "3014040071");

                var xhr = new XMLHttpRequest();
                xhr.withCredentials = true;

                xhr.addEventListener("readystatechange", function () {
                    if (this.readyState === 4) {
						var json = JSON.parse(xhr.responseText);
						var eta = json.pickup_eta;
						console.log(this.responseText);
                        console.log(eta);
                    }
                });

                xhr.open("POST", "/api/postmates/customers/cus_Ke9kOEURVrKV7V/delivery_quotes");

                xhr.send(data);
			}

        </script>
    </body>
</html>
